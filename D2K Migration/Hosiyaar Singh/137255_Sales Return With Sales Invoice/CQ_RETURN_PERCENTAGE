SELECT ginview.fnc_uk UK,
'@DocumentId@'                                          RTCODE,
       SUM (SALINVQTY)                                         SALINVQTY,
       SUM (SALRTQTY)                                          SALRTQTY,
       ROUND ( ( (SUM (SALRTQTY) / SUM (SALINVQTY)) * 100), 2) RTPRCNT
  FROM (SELECT null SALINVQTY, SUM (NVL (SALRTDET.QTY, null)) SALRTQTY
          FROM SALRTDET, SALRTMAIN
         WHERE     SALRTDET.RTCODE = SALRTMAIN.RTCODE
               AND PCODE = (SELECT pcode
                              FROM salrtmain
                             WHERE rtcode = '@DocumentId@')
               AND SALRTMAIN.YCODE = (SELECT ycode
                                        FROM salrtmain
                                       WHERE rtcode = '@DocumentId@')
        UNION ALL
        SELECT SUM (NVL (SALINVDET.INVQTY, null)) SALINVQTY, null SALRTQTY
          FROM SALINVDET, SALINVMAIN
         WHERE     SALINVDET.INVCODE = SALINVMAIN.INVCODE
               AND PCODE = (SELECT pcode
                              FROM salrtmain
                             WHERE rtcode = '@DocumentId@')
               AND SALINVMAIN.YCODE = (SELECT ycode
                                         FROM salrtmain
                                        WHERE rtcode = '@DocumentId@'))