DROP VIEW GINSSOT.DIM$INVDCMAIN;

/* Formatted on 10/9/2021 11:09:09 AM (QP5 v5.294) */
CREATE OR REPLACE FORCE VIEW GINSSOT.DIM$INVDCMAIN
(
   DCCODE,
   ECODE,
   CNLECODE,
   PCODE,
   AGCODE,
   TRPCODE,
   INVCODE,
   OUTLOCCODE,
   ADMSITE_CODE_OWNER,
   ADMSITE_CODE,
   PRICELISTCODE,
   TRANSFERIN_RTCODE,
   LINKED_DCCODE,
   SALTRADEGRP_CODE,
   FORMCODE,
   ORDCODE,
   LINKED_PSITE_PACKET_ID,
   INTGCODE,
   DOCCODE,
   YCODE,
   ADMOU_CODE,
   DCDT,
   TIME,
   CNLDT,
   DCBARCODE,
   REM,
   SCHEME_DOCNO,
   DOCNO,
   DISCOUNT_FACTOR,
   PRICE_ROUNDOFF,
   SALETYPE,
   STATUS,
   AGAINST_SO,
   PRICETYPE,
   ROUNDOFF_LIMIT,
   INCL_VAT_IN_DIST,
   DISCOUNT_MODE,
   DISCOUNT_BASIS,
   CMPTAX_CODE_BASIS,
   DOC_STATUS
)
   BEQUEATH DEFINER
AS
   SELECT DCCODE,
          ECODE,
          CNLECODE,
          PCODE,
          AGCODE,
          TRPCODE,
          INVCODE,
          OUTLOCCODE,
          ADMSITE_CODE_OWNER,
          ADMSITE_CODE,
          PRICELISTCODE,
          TRANSFERIN_RTCODE,
          LINKED_DCCODE,
          SALTRADEGRP_CODE,
          FORMCODE,
          ORDCODE,
          LINKED_PSITE_PACKET_ID,
          INTGCODE,
          DOCCODE,
          YCODE,
          ADMOU_CODE,
          DCDT,
          TIME,
          CNLDT,
          DCBARCODE,
          REM,
          SCHEME_DOCNO,
          DOCNO,
          DISCOUNT_FACTOR,
          PRICE_ROUNDOFF,
          DECODE (SALETYPE,  'C', 'CONSIGNMENT',  'O', 'OUTRIGHT') SALETYPE,
          DECODE (STATUS,
                  'P', 'PENDING',
                  'I', 'INVOICED',
                  'C', 'CANCELLED')
             STATUS,
          DECODE (NVL (AGAINST_SO, 'N'),  'Y', 'YES',  'N', 'NO')  AGAINST_SO,
          DECODE (NVL (PRICETYPE, 'M'),
                  'F', 'FIFO',
                  'M', 'RSP',
                  'L', 'MRP',
                  'W', 'WSP',
                  'C', 'EFFECTIVE RATE (LAST LANDING COST)',
                  'R', 'STANDARD RATE',
                  'B', 'BASIC RATE (LAST PURCHASE)')
             PRICETYPE,
          DECODE (NVL (ROUNDOFF_LIMIT, 'N'),  'Y', 'YES',  'N', 'NO')
             ROUNDOFF_LIMIT,
          DECODE (NVL (INCL_VAT_IN_DIST, 'N'),  'Y', 'YES',  'N', 'NO')
             INCL_VAT_IN_DIST,
          DECODE (NVL (DISCOUNT_MODE, 'U'),  'U', 'MARKUP',  'D', 'MARKDOWN')
             DISCOUNT_MODE,
          DECODE (NVL (DISCOUNT_BASIS, 'N'),
                  'B', 'ON BASE PRICE',
                  'N', 'ON NET PRICE')
             DISCOUNT_BASIS,
          DECODE (NVL (CMPTAX_CODE_BASIS, 'D'),
                  'S', 'SOURCE',
                  'D', 'DESTINATION')
             CMPTAX_CODE_BASIS,
          DECODE (DOC_STATUS,  'O', 'OPEN',  'C', 'CLOSED')        DOC_STATUS
     FROM INVDCMAIN
   WITH READ ONLY;
