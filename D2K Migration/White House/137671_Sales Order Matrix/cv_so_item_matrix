/* Formatted on 9/8/2021 3:16:20 PM (QP5 v5.294) */
CREATE OR REPLACE FORCE VIEW GINVIEW.CV_SO_ITEM_MATRIX_CV
AS
     SELECT ginview.fnc_uk                                   UK,
            ordcode,
            Department || ' ' || category2 || ' ' || category3 Item,
            order_rate,
            MRP                                              order_rsp,
            TRIM (category4)                                 Item_size,
            SUM (ordered_quantity)                           Qty,
            SUM (
               order_rate * ordered_quantity)
            OVER (
               PARTITION BY ordcode,
                            Department || ' ' || category2 || ' ' || category3,
                            order_rate,
                            MRP
               ORDER BY
                  ordcode,
                  Department || ' ' || category2 || ' ' || category3,
                  order_rate)
               Amount
       FROM ginview.lv_so_item A, ginview.lv_item B
      WHERE A.icode = B.code                            --AND ordcode = 114557
   GROUP BY ordcode,
            Department || ' ' || category2 || ' ' || category3,
            order_rate,
            MRP,
            TRIM (category4),
            ordered_quantity;