/* Formatted on 29/07/2022 12:14:15 (QP5 v5.294) */
SELECT ginview.fnc_uk uk,
       tab1.*,
       col1,
       col2,
       col3,
       col4,
       col5,
       col6,
       col7,
       col8,
       col9,
       col10
  FROM (  SELECT dccode,
                 division,
                 item_name,
                 hsn,
                 rate,
                 rsp,
                 MRP,
                 unit,
                 SUM (CASE WHEN seq = 1 THEN qty ELSE 0 END) size1,
                 SUM (CASE WHEN seq = 2 THEN qty ELSE 0 END) size2,
                 SUM (CASE WHEN seq = 3 THEN qty ELSE 0 END) size3,
                 SUM (CASE WHEN seq = 4 THEN qty ELSE 0 END) size4,
                 SUM (CASE WHEN seq = 5 THEN qty ELSE 0 END) size5,
                 SUM (CASE WHEN seq = 6 THEN qty ELSE 0 END) size6,
                 SUM (CASE WHEN seq = 7 THEN qty ELSE 0 END) size7,
                 SUM (CASE WHEN seq = 8 THEN qty ELSE 0 END) size8,
                 SUM (CASE WHEN seq = 9 THEN qty ELSE 0 END) size9,
                 SUM (CASE WHEN seq = 10 THEN qty ELSE 0 END) size10
            FROM (  SELECT dccode,
                           department         division,
                              category1
                           || ' '
                           || category2
                           || ' '
                           || category3
                              Item_Name,
                           TRIM (category4)   item_size,
                           DENSE_RANK ()
                           OVER (PARTITION BY dccode ORDER BY TRIM (category4))
                              seq,
                           SUM (challan_quantity) qty,
                           challan_net_rate   rate,
                           challan_rsp        rsp,
                           i.HSN_CODE         HSN,
                           i.MRP              MRP,
                           UOM                UNIT
                      FROM ginview.lv_dc_item d, ginview.lv_item i
                     WHERE d.icode = i.code
                  --and invcode in(1298047)
                  GROUP BY dccode,
                           department,
                              category1
                           || ' '
                           || category2
                           || ' '
                           || category3,
                           challan_net_rate,
                           challan_rsp,
                           TRIM (category4),
                           i.HSN_CODE,
                           i.MRP,
                           UOM)
        --   WHERE ordcode = 1448
        GROUP BY dccode,
                 division,
                 item_name,
                 hsn,
                 rate,
                 rsp,
                 MRP,
                 unit) tab1,
       (  SELECT dccode,
                 MAX (CASE WHEN seq = 1 THEN i_size ELSE NULL END) col1,
                 MAX (CASE WHEN seq = 2 THEN i_size ELSE NULL END) col2,
                 MAX (CASE WHEN seq = 3 THEN i_size ELSE NULL END) col3,
                 MAX (CASE WHEN seq = 4 THEN i_size ELSE NULL END) col4,
                 MAX (CASE WHEN seq = 5 THEN i_size ELSE NULL END) col5,
                 MAX (CASE WHEN seq = 6 THEN i_size ELSE NULL END) col6,
                 MAX (CASE WHEN seq = 7 THEN i_size ELSE NULL END) col7,
                 MAX (CASE WHEN seq = 8 THEN i_size ELSE NULL END) col8,
                 MAX (CASE WHEN seq = 9 THEN i_size ELSE NULL END) col9,
                 MAX (CASE WHEN seq = 10 THEN i_size ELSE NULL END) col10
            FROM (SELECT DISTINCT
                         dccode,
                         TRIM (category4) i_size,
                         DENSE_RANK ()
                         OVER (PARTITION BY dccode ORDER BY TRIM (category4))
                            seq
                    FROM ginview.lv_dc_item d, ginview.lv_item i
                   WHERE d.icode = i.code)
        GROUP BY dccode) tab2
 WHERE tab1.dccode = tab2.dccode