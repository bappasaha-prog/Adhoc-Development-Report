/* Formatted on 13-07-2022 15:38:32 (QP5 v5.294) */
  SELECT GINVIEW.FNC_UK                             UK,
         ordcode,
         article_name,
         item_name,
         hsn,
         rate,
         --rsp,
         unit,
         SUM (CASE WHEN seq = 1 THEN qty ELSE 0 END) size1,
         SUM (CASE WHEN seq = 2 THEN qty ELSE 0 END) size2,
         SUM (CASE WHEN seq = 3 THEN qty ELSE 0 END) size3,
         SUM (CASE WHEN seq = 4 THEN qty ELSE 0 END) size4,
         SUM (CASE WHEN seq = 5 THEN qty ELSE 0 END) size5,
         SUM (CASE WHEN seq = 6 THEN qty ELSE 0 END) size6,
         SUM (CASE WHEN seq = 7 THEN qty ELSE 0 END) size7,
         SUM (CASE WHEN seq = 8 THEN qty ELSE 0 END) size8,
         SUM (CASE WHEN seq = 9 THEN qty ELSE 0 END) size9,
         SUM (CASE WHEN seq = 10 THEN qty ELSE 0 END) size10
    FROM (  SELECT ginview.fnc_uk uk,
                   ordcode,
                   article_name,
                      category1
                   || ' '
                   || category2
                   || ' '
                   || category4
                   || ' '
                   || category5
                   || ' '
                   || category6
                      Item_Name,
                   TRIM (category3) item_size,
                   DENSE_RANK ()
                      OVER (PARTITION BY ordcode ORDER BY TRIM (category3))
                      seq,
                   SUM (ordqty) qty,
                   rate,
                   d.rsp,
                   i.HSN_CODE   HSN,
                   UOM          UNIT
              FROM purorddet d, ginview.lv_item i
             WHERE d.icode = i.code
          --and invcode in(1298047)
          GROUP BY ordcode,
                   article_name,
                      category1
                   || ' '
                   || category2
                   || ' '
                   || category4
                   || ' '
                   || category5
                   || ' '
                   || category6,
                   rate,
                   d.rsp,
                   TRIM (category3),
                   i.HSN_CODE,
                   UOM)
--   WHERE ordcode = 1448
GROUP BY ordcode,
         article_name,
         item_name,
         hsn,
         rate,
         --rsp,
         unit